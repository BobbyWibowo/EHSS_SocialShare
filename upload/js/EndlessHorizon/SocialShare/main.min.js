/*
 * EHSS_SocialShare
 * by Bobby Wibowo
 */

$(document).ready(function(){function e(e){return EHSS_settings.debug&&console.log(o+e),!0}function i(e,i,n){var t=void 0!=window.screenLeft?window.screenLeft:screen.left,s=void 0!=window.screenTop?window.screenTop:screen.top,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,l=o/2-i/2+t,d=a/2-n/2+s,r=window.open(e,null,"toolbar=0, status=0, scrollbars=yes, width="+i+", height="+n+", top="+d+", left="+l);window.focus&&r.focus()}function n(e){return encodeURIComponent(e).replace("~","%7e").replace("'","%27")}function t(e,i){var t=EHSS_sites[e].popupURL;return EHSS_sites[e].pinterest&&-1===t.indexOf("&media=")&&(f=$("head").find('meta[property="og:image"]'),f.length&&(t+="&media="+n($(f[0]).attr("content")))),t.replace("{url}",n(i)).replace("{title}",n(document.title))}if(EHSS_sites&&Object.keys(EHSS_sites).length){var o="[Endless Horizon] Social Share: ";if(!EHSS_settings||!Object.keys(EHSS_settings).length)return void e("Failing.. Could not load settings.");var a,l=$('<div class="ehss_overlay" style="display: none"><div class="ehss_items"><div class="ehss_inner"><ul></ul></div></div></div>'),d=$.parseJSON(EHSS_settings.counts.replace(/&quot;/g,'"')),r=0,c=0;for(s in EHSS_sites)if(!EHSS_sites[s].disabled){var p=$("<li></li>"),u="",S="",h=EHSS_sites[s].shareCountID;if(d&&d.hasOwnProperty(h)){var f=d[h],g=EHSS_settings[1===f?"count-s":"count-p"];S+='<i class="ehss_count" style="color: '+EHSS_sites[s].bgColor+'" title="'+g.replace("{x}",f)+'">'+f+"</i>",c+=1}u+='<a data-id="'+s+'"><span style="background-color: '+EHSS_sites[s].bgColor+'"><i class="'+EHSS_sites[s].iconClass+'"></i>'+S+"</span></a><span>"+s+"</span>",p.append(u),l.find(".ehss_items .ehss_inner ul").append(p),r+=1}l.click(function(){1===parseInt($(this).css("opacity"))&&$(this).fadeToggle(400,"swing")}),l.find(".ehss_items .ehss_inner ul li").click(function(e){e.stopPropagation()}),l.find(".ehss_items .ehss_inner ul li a").click(function(e){e.preventDefault();var n=$(this).data("id"),s=t(n,$(a).data("permalink")||EHSS_settings.url),o=EHSS_sites[n].popupBlank;o?window.open(s,"_blank"):i(s,EHSS_sites[n].popupSize.w,EHSS_sites[n].popupSize.h)}),$("body").append(l),$("body").on("click",".ehss_button",function(e){e.preventDefault(),"none"===l.css("display")&&(a=this,l.find(".ehss_count").attr("style",$(a).data("permalink")?"display: none":""),l.fadeToggle(400,"swing"))}),e(r+" item"+(1===r?"":"s")+" for the social share widget were initialized."),e("Share counter was "+(c?"initialized for "+c+" item"+(1===c?"":"s"):"not initialized for any items")+".")}});