/*
 * EH_SocialShare
 * by Bobby Wibowo
 */

$(document).ready(function(){function e(e){return EHSS_settings.debug&&console.log("[Endless Horizon] Social Share: "+e),!0}function i(e,i,t){var n=void 0!=window.screenLeft?window.screenLeft:screen.left,s=void 0!=window.screenTop?window.screenTop:screen.top,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,d=o/2-i/2+n,c=a/2-t/2+s,l=window.open(e,null,"toolbar=0, status=0, scrollbars=yes, width="+i+", height="+t+", top="+c+", left="+d);window.focus&&l.focus()}function t(e){return encodeURIComponent(e).replace("~","%7e").replace("'","%27")}function n(e,i){var n=EHSS_sites[e].url;return EHSS_sites[e].pin&&-1===n.indexOf("&media=")&&(f=$("head").find('meta[property="og:image"]'),f.length&&(n+="&media="+t($(f[0]).attr("content")))),n.replace("{url}",t(i)).replace("{title}",t(document.title))}if(EHSS_sites&&Object.keys(EHSS_sites).length){var o=$("body");if(!EHSS_settings||!Object.keys(EHSS_settings).length)return void e("Failing.. Could not load settings.");var a,d=$('<div class="ehss_overlay" style="display: none"><div class="ehss_items"><div class="ehss_inner"><ul></ul></div></div></div>'),c=$.parseJSON(EHSS_settings.counts.replace(/&quot;/g,'"')),l=0,r=0;for(s in EHSS_sites){var u=$("<li></li>"),h="",p="",S=EHSS_sites[s].scid;if(c&&c.hasOwnProperty(S)){var f=c[S],g=EHSS_settings[1===f?"count-s":"count-p"];p+='<i class="ehss_count" style="color: '+EHSS_sites[s].bg+'" title="'+g.replace("{x}",f)+'">'+f+"</i>",r+=1}h+='<a data-id="'+s+'"><span style="background-color: '+EHSS_sites[s].bg+'"><i class="'+EHSS_sites[s].ic+'"></i>'+p+"</span></a><span>"+s+"</span>",u.append(h),d.find(".ehss_items .ehss_inner ul").append(u),l+=1}if(d.click(function(){1===parseInt($(this).css("opacity"))&&$(this).fadeToggle(400,"swing")}),d.find(".ehss_items .ehss_inner ul li").click(function(e){e.stopPropagation()}),d.find(".ehss_items .ehss_inner ul li a").click(function(e){e.preventDefault();var t=$(this).data("id"),s=n(t,$(a).data("permalink")||EHSS_settings.url),o=EHSS_sites[t].pb;o?window.open(s,"_blank"):i(s,EHSS_sites[t].dim.w,EHSS_sites[t].dim.h)}),o.append(d),o.on("click",".ehss_button",function(e){e.preventDefault(),"none"==d.css("display")&&(a=this,d.find(".ehss_count").css("display",$(a).data("permalink")?"none":"block"),d.fadeToggle(400,"swing"))}),e(l+" item"+(1===l?"":"s")+" for the social share widget were initialized."),e("Share counter was "+(r?"initialized for "+r+" item"+(1===r?"":"s"):"not initialized for any items")+"."),EHSS_settings.fsbanim){var _=o.find(".ehss_button.floating_l").add(".ehss_button.floating_r").first(),m=_.innerWidth()+1,w=_.data("w"),E=_.find("span"),H=400;E.css("opacity",0),_.css("width",w),_.toggleClass("ehss_ready"),_.hover(function(){$(this).animate({width:m+"px"},H),E.animate({opacity:1},H)},function(){$(this).animate({width:w},H),E.animate({opacity:0},H)})}}});